models:
  gpt-4o-mini:
    provider: lm-studio
    temperature: 0.1
    max_tokens: 400

tools:
  workspace.read_file:
    type: local
    handler: workspace.read_file
    description: Read-only access to repository files
    allowed_globs:
      - "**/*.md"
      - "**/*.py"
      - "**/*.txt"
    denied_globs:
      - "**/.git/**"
  workspace.write_file:
    type: local
    handler: workspace.write_file
    description: Write access constrained to source/docs files
    allowed_globs:
      - "src/**/*.py"
      - "*.md"
      - "docs/**/*.md"
    denied_globs:
      - "**/.git/**"
  workspace.shell_exec:
    type: local
    handler: workspace.shell_exec
    description: Execute bounded shell commands
    allowed_globs:
      - "src/**"
    denied_globs:
      - "**/.git/**"
  workspace.repo_summary:
    type: local
    handler: workspace.repo_summary
    description: Summarize repo contents and hash file lists

policies:
  safety.default:
    description: Guard against workspace escapes and destructive edits
    rules:
      - "Never touch files outside the mounted /workspace directory."
      - "Prefer reversible edits and checkpoint before destructive changes."
  review.default:
    description: Ensure reviewer validates every executor action
    rules:
      - "Require explicit validation notes for each completed step."
  workspace.write-guard:
    description: Executor must justify every write operation
    rules:
      - "Executor must describe targeted files before editing."
      - "Reviewer must confirm diffs before completion."

agents:
  planner:
    description: Decompose goals and produce task DAGs
    model: gpt-4o-mini
    tools:
      - workspace.read
    policies:
      - safety.default
  executor:
    description: Execute plan steps using approved tools
    model: gpt-4o-mini
    tools:
      - workspace.read_file
      - workspace.write_file
      - workspace.shell_exec
      - workspace.repo_summary
    policies:
      - safety.default
      - workspace.write-guard
  reviewer:
    description: Validate outputs and enforce policies
    model: gpt-4o-mini
    tools:
      - workspace.read_file
    policies:
      - review.default

mcp_endpoints:
  docs-vector-store:
    transport: http
    url: http://host.docker.internal:9000/mcp
    auth_token_env: DOCS_MCP_TOKEN
    rate_limit_per_minute: 30
  issue-tracker:
    transport: ws
    url: ws://host.docker.internal:9100/mcp
    rate_limit_per_minute: 20
